---
documentclass: article
title: "Solvabilté II : Calibration des chocs de capital de solvabilité requis avec expected shortfall."
author: "Kevin BAMOUNI"
date: "01/09/2020"
geometry: margin=1in
fontfamily: mathptmx
fontsize: 11pt
lang: fr-FR
# spacing: double
endnote: no
citecolor: cyan
output:
  pdf_document:
    df_print: kable
    fig_width: 7
    fig_height: 4
    fig_caption: true
    citation_package: natbib
    latex_engine: lualatex
bibliography: master.bib
---


Conservatoire National des Arts et Métiers (CNAM Paris) / EFAB  
Master 2 Actuariat  
STA217 Gestion quantitative du risque en finance et assurance  
  
Projet annuel basé sur l'article "Solvency II solvency capital requirement for life insurance companies based on expected shortfall" de Tim J. Boonen publié en Octobre 2017.


```{r, echo = FALSE, fig.align = 'center', message=FALSE}
# Libraries
library(quantmod)
library(ggplot2)
library(dplyr)
library(cowplot)
library(actuar)
```


```{r, echo = FALSE, fig.align = 'center', message=FALSE}
# MSCI data load
msci <- read.csv(file = 'data/historyindex.csv', sep = ";")[ ,c('Date', 'Price')]
msci$Date <- as.Date(msci$Date, "%d-%m-%Y")
```


# INTRODUCTION

Academic workflow, certainly in political science, is at a crossroads. The *American Journal of Political Science* (*AJPS*) announced a (my words) ["show your work" initiative](http://ajps.org/2015/03/26/the-ajps-replication-policy-innovations-and-revisions/) in which authors who are tentatively accepted for publication at the journal must hand over the raw code and data that produced the results shown in the manuscript. The editorial team at *AJPS* then reproduces the code from the manuscript. Pending successful replication, the manuscript moves toward publication. The *AJPS* might be at the fore of this movement, and it could be the most aggressive among political science journals, but other journals in our field have signed the joint [Data Access & Research Transparency](http://www.dartstatement.org/) (DART) initiative. This, at a bare minimum, requires uploading code from quantitatively-oriented published articles to in-house directories hosted by the journal or to services like [Dataverse](http://dataverse.org/). 

# 1. SOLVABILITE 2


# 2. MODELE DE L'ARTICLE : ESPECTED SHORTFALL POUR LA CALIBRATION DES CHOCS DE CALCUL DU SCR (CSR)


## DESCRIPTION


## MODELE DE CALIBRATION DES CHOCS DE CAPITAL DE SOLVABILITE REQUIS

### CALIBRATION DU CHOC SUR LES ACTIONS

Calibration du choc scr sur les actions

```{r, echo = FALSE, fig.align = 'center', message=FALSE}
# Most basic bubble plot
p1 <- ggplot(msci, aes(x=Date, y=Price)) +
  geom_area(fill = "lightgray", color="blue") + 
  xlab("Date") + ylab("Price")  + ggtitle("Evolution de la valeur de l'indice MSCI") + theme_classic()

msci_return <-data.frame( diff(log(msci[,'Price']))[-1]) # formule de calcul : log[Pt] - log[P(t-1)]
colnames(msci_return) <- c("msci_return")

p2 <- ggplot(msci_return, aes(x=index(msci_return), y=msci_return)) +
  geom_line( color="red") + 
  xlab("index") + ylab("return") + ggtitle("Rendement de l'indice MSCI") + theme_classic()

plot_grid(p1, p2, ncol = 1, align = "v")

```

Distribution des rendements

```{r, echo = FALSE, fig.align = 'center', message=FALSE}
p3 <- ggplot(msci_return, aes(msci_return)) +
  geom_histogram( bins = 50, color="darkgreen", fill="white") +
  xlab("return") + ylab("frequence") + ggtitle("Rendement de l'indice MSCI") +
  theme_classic()

p4 <- ggplot(msci_return, aes(msci_return)) +
  geom_density(color="goldenrod2", fill = "gold1", alpha = 0.1) +
  stat_function(fun = dnorm, args = list(mean(msci_return$msci_return), sd(msci_return$msci_return)), color = "red") +
  geom_vline(xintercept = mean(msci_return$msci_return), colour = "#FF3721", linetype = "dashed") +
  xlab("return") + ylab("frequence") + ggtitle("Rendement de l'indice MSCI") +
  theme_classic()

plot_grid(p3, p4)

```

Value at risque historique sur les données de rendements annualisées 

```{r, echo = FALSE, fig.align = 'center', message=FALSE}
# Calcul de la VAR historique des données
histo_VAR <- round(quantile(msci_return, probs = c(0, 0.0005, 0.005, 0.01, 0.025, 0.5, 0.975, 0.99, 0.995, 0.9995, 1), na.rm = TRUE, names = TRUE, type = 1), 4)
histo_VAR
```

Value at risque d'une loi normale théorique

```{r, echo = FALSE, fig.align = 'center', message=FALSE}
# Calcul de la VAR théorique de la loi normale en supposant que les rendements suivent une loi normale
theo_VAR <- round(qnorm(c(0, 0.0005, 0.005, 0.01, 0.025, 0.5, 0.975, 0.99, 0.995, 0.9995, 1),mean=mean(msci_return$msci_return),sd=sd(msci_return$msci_return)), 4)
theo_VAR
```


```{r, echo = FALSE, fig.align = 'center', message=FALSE}
# msci_return$msci_return[msci_return$msci_return<histo_VAR[3]]
histo_ES <- round(mean(msci_return$msci_return[msci_return$msci_return<=histo_VAR[3]]), 4)
histo_ES
```


### CALIBRATION DU CHOC SUR LES TAUX


### CALIBRATION DU CHOC SUR LA LONGEVITE


# 3. THEORIE DES VALEURS EXTREMES POUR LA CALIBRATION DES CHOCS


# CONCLUSION


# REFERENCES 


# ANNEXES  avec codes, figures en plus etc.).

## packages R
## articles
